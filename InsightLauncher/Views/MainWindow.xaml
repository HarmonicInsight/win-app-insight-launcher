<Window x:Class="InsightLauncher.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:InsightLauncher.Controls"
        xmlns:vm="clr-namespace:InsightLauncher.ViewModels"
        xmlns:models="clr-namespace:InsightLauncher.Models"
        Title="Insight Launcher"
        Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">

    <!-- WindowChrome for custom resize handling -->
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0"
                      ResizeBorderThickness="8"
                      GlassFrameThickness="0"
                      CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Grid Background="Transparent">
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <Border Background="{StaticResource BackgroundGradient}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Margin="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="48"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="36"/>
                </Grid.RowDefinitions>

                <!-- ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒ¼ -->
                <Border Grid.Row="0"
                        Background="{StaticResource BackgroundSecondaryBrush}"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="0,0,0,1"
                        CornerRadius="8,8,0,0"
                        MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- ãƒ­ã‚´ãƒ»ã‚¿ã‚¤ãƒˆãƒ« -->
                        <StackPanel Grid.Column="0"
                                    Orientation="Horizontal"
                                    VerticalAlignment="Center"
                                    Margin="16,0">
                            <TextBlock Text="Insight Launcher"
                                       Foreground="{StaticResource PrimaryBrush}"
                                       FontFamily="Segoe UI Variable, Segoe UI, Yu Gothic UI"
                                       FontWeight="SemiBold"
                                       FontSize="15"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- æ¤œç´¢ãƒãƒ¼ -->
                        <Grid Grid.Column="1" Margin="24,0" MaxWidth="500">
                            <Border Background="{StaticResource BackgroundCardBrush}"
                                    BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6"
                                    Padding="12,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0"
                                               Text="ðŸ”"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Margin="0,0,8,0"
                                               Opacity="0.5"/>

                                    <TextBox Grid.Column="1"
                                             Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                                             Background="Transparent"
                                             Foreground="{StaticResource TextPrimaryBrush}"
                                             BorderThickness="0"
                                             VerticalAlignment="Center"
                                             FontSize="13">
                                        <TextBox.Style>
                                            <Style TargetType="TextBox">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="TextBox">
                                                            <Grid>
                                                                <TextBlock Text="ãƒ•ã‚¡ã‚¤ãƒ«ã€äºˆå®šã€ãŠçŸ¥ã‚‰ã›ã‚’æ¤œç´¢..."
                                                                           Foreground="{StaticResource TextMutedBrush}"
                                                                           VerticalAlignment="Center"
                                                                           Visibility="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=Invert}"/>
                                                                <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center"/>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>

                                    <Button Grid.Column="2"
                                            Style="{StaticResource IconButton}"
                                            Command="{Binding ClearSearchCommand}"
                                            Visibility="{Binding SearchQuery, Converter={StaticResource NullToVisibilityConverter}}"
                                            Width="24" Height="24">
                                        <TextBlock Text="âœ•" FontSize="10" Foreground="{StaticResource TextMutedBrush}"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <!-- æ¤œç´¢çµæžœãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ -->
                            <Popup IsOpen="{Binding ShowSearchResults}"
                                   PlacementTarget="{Binding RelativeSource={RelativeSource AncestorType=Grid}}"
                                   Placement="Bottom"
                                   StaysOpen="False"
                                   AllowsTransparency="True">
                                <Border Background="{StaticResource BackgroundCardBrush}"
                                        BorderBrush="{StaticResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Width="500"
                                        MaxHeight="400"
                                        Margin="0,4,0,0">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="8">
                                        <ItemsControl ItemsSource="{Binding SearchResults}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate DataType="{x:Type models:SearchResult}">
                                                    <Button Command="{Binding DataContext.ExecuteSearchResultCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}"
                                                            Margin="0,0,0,4">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Background" Value="Transparent"/>
                                                                <Setter Property="BorderThickness" Value="0"/>
                                                                <Setter Property="Cursor" Value="Hand"/>
                                                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                                <Setter Property="Template">
                                                                    <Setter.Value>
                                                                        <ControlTemplate TargetType="Button">
                                                                            <Border Background="{TemplateBinding Background}"
                                                                                    CornerRadius="6"
                                                                                    Padding="12,8">
                                                                                <ContentPresenter/>
                                                                            </Border>
                                                                            <ControlTemplate.Triggers>
                                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                                    <Setter Property="Background" Value="{StaticResource BackgroundHoverBrush}"/>
                                                                                </Trigger>
                                                                            </ControlTemplate.Triggers>
                                                                        </ControlTemplate>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Style>
                                                        </Button.Style>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0"
                                                                       Text="{Binding Icon}"
                                                                       FontSize="18"
                                                                       VerticalAlignment="Center"
                                                                       Margin="0,0,12,0"/>
                                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                                <TextBlock Text="{Binding Title}"
                                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                                           FontWeight="Medium"
                                                                           TextTrimming="CharacterEllipsis"/>
                                                                <TextBlock Text="{Binding Subtitle}"
                                                                           Foreground="{StaticResource TextMutedBrush}"
                                                                           FontSize="11"
                                                                           TextTrimming="CharacterEllipsis"/>
                                                            </StackPanel>
                                                        </Grid>
                                                    </Button>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>

                        <!-- ãƒ†ãƒ¼ãƒžåˆ‡æ›¿ -->
                        <Button Grid.Column="2"
                                Style="{StaticResource IconButton}"
                                Command="{Binding ToggleThemeCommand}"
                                ToolTip="ãƒ†ãƒ¼ãƒžåˆ‡æ›¿"
                                Margin="0,0,8,0">
                            <TextBlock FontSize="14">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="ðŸŒ™"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsDarkMode}" Value="False">
                                                <Setter Property="Text" Value="â˜€ï¸"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Button>

                        <!-- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
                        <StackPanel Grid.Column="3"
                                    Orientation="Horizontal">
                            <Button Style="{StaticResource WindowControlButton}"
                                    Command="{Binding MinimizeCommand}">
                                <TextBlock Text="â”€" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </Button>
                            <Button Style="{StaticResource WindowControlButton}"
                                    Command="{Binding MaximizeCommand}">
                                <TextBlock Text="â–¡" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </Button>
                            <Button Style="{StaticResource CloseButton}"
                                    Command="{Binding CloseCommand}">
                                <TextBlock Text="âœ•" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
                <Grid Grid.Row="1" Margin="24">
                    <Grid.ColumnDefinitions>
                        <!-- å·¦: æ—¥æ™‚/å¤©æ°— + ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
                        <ColumnDefinition Width="260"/>
                        <ColumnDefinition Width="24"/>
                        <!-- å³: ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- å·¦ã‚«ãƒ©ãƒ  -->
                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="16"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- æ—¥æ™‚ãƒ»å¤©æ°— -->
                        <controls:DateTimeWeatherControl Grid.Row="0"/>

                        <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
                        <Border Grid.Row="2"
                                Style="{StaticResource CardStyle}">
                            <controls:QuickActionsControl/>
                        </Border>
                    </Grid>

                    <!-- å³ã‚«ãƒ©ãƒ : ã‚¿ãƒ–ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
                    <TabControl Grid.Column="2"
                                Style="{StaticResource MainTabControl}">
                        <!-- ãƒ•ã‚¡ã‚¤ãƒ« -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <TextBlock Text="ãƒ•ã‚¡ã‚¤ãƒ«"/>
                            </TabItem.Header>
                            <controls:RecentFilesControl/>
                        </TabItem>

                        <!-- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <TextBlock Text="ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼"/>
                            </TabItem.Header>
                            <controls:CalendarControl/>
                        </TabItem>

                        <!-- ã‚¿ã‚¹ã‚¯ -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ã‚¿ã‚¹ã‚¯"/>
                                    <Border Background="{StaticResource PrimaryBrush}"
                                            CornerRadius="8"
                                            Padding="6,2"
                                            Margin="6,0,0,0"
                                            Visibility="{Binding PendingTodoCount, Converter={StaticResource NullToVisibilityConverter}}">
                                        <TextBlock Text="{Binding PendingTodoCount}"
                                                   Foreground="White"
                                                   FontSize="10"
                                                   FontWeight="SemiBold"/>
                                    </Border>
                                </StackPanel>
                            </TabItem.Header>
                            <controls:TodoControl/>
                        </TabItem>

                        <!-- ãŠçŸ¥ã‚‰ã› -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ãŠçŸ¥ã‚‰ã›"/>
                                    <Border Background="{StaticResource ErrorBrush}"
                                            CornerRadius="8"
                                            Padding="6,2"
                                            Margin="6,0,0,0"
                                            Visibility="{Binding UnreadAnnouncementCount, Converter={StaticResource NullToVisibilityConverter}}">
                                        <TextBlock Text="{Binding UnreadAnnouncementCount}"
                                                   Foreground="White"
                                                   FontSize="10"
                                                   FontWeight="SemiBold"/>
                                    </Border>
                                </StackPanel>
                            </TabItem.Header>
                            <controls:AnnouncementsControl/>
                        </TabItem>

                        <!-- ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ"/>
                                    <Border Background="{StaticResource WarningBrush}"
                                            CornerRadius="8"
                                            Padding="6,2"
                                            Margin="6,0,0,0"
                                            Visibility="{Binding PendingSurveyCount, Converter={StaticResource NullToVisibilityConverter}}">
                                        <TextBlock Text="{Binding PendingSurveyCount}"
                                                   Foreground="White"
                                                   FontSize="10"
                                                   FontWeight="SemiBold"/>
                                    </Border>
                                </StackPanel>
                            </TabItem.Header>
                            <controls:SurveyControl/>
                        </TabItem>

                        <!-- ãƒãƒ¼ãƒ  -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <TextBlock Text="ãƒãƒ¼ãƒ "/>
                            </TabItem.Header>
                            <controls:TeamControl/>
                        </TabItem>

                        <!-- è¨­å®š -->
                        <TabItem Style="{StaticResource MainTabItem}">
                            <TabItem.Header>
                                <TextBlock Text="è¨­å®š"/>
                            </TabItem.Header>
                            <controls:SettingsControl/>
                        </TabItem>
                    </TabControl>
                </Grid>

                <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
                <Border Grid.Row="2"
                        Background="{StaticResource BackgroundSecondaryBrush}"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="0,1,0,0"
                        CornerRadius="0,0,8,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- ãƒ­ãƒ¼ã‚«ãƒ«é ˜åŸŸãƒ©ãƒ™ãƒ« -->
                        <TextBlock Grid.Column="0"
                                   Text="ãƒ­ãƒ¼ã‚«ãƒ«"
                                   FontFamily="Segoe UI Variable, Segoe UI, Yu Gothic UI"
                                   Foreground="{StaticResource TextTertiaryBrush}"
                                   FontSize="11"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   Margin="16,0"/>

                        <!-- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ -->
                        <TextBlock Grid.Column="1"
                                   Text="Insight Launcher v1.0.0"
                                   FontFamily="Segoe UI Variable, Segoe UI, Yu Gothic UI"
                                   Foreground="{StaticResource TextTertiaryBrush}"
                                   FontSize="11"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>

                        <!-- é›†ä¸­ç®¡ç†ãƒ©ãƒ™ãƒ« -->
                        <TextBlock Grid.Column="2"
                                   Text="é›†ä¸­ç®¡ç†"
                                   FontFamily="Segoe UI Variable, Segoe UI, Yu Gothic UI"
                                   Foreground="{StaticResource TextTertiaryBrush}"
                                   FontSize="11"
                                   HorizontalAlignment="Right"
                                   VerticalAlignment="Center"
                                   Margin="0,0,16,0"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>
